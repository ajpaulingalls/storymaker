<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=1080, height=1920" />
    <title>Story</title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Sans+3:wght@300;400;600;700&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        width: 1080px;
        height: 1920px;
        overflow: hidden;
        background: #000;
      }

      /* Pause all animations until recording has started */
      body:not(.animations-started) * {
        animation-play-state: paused !important;
      }

      /* Background Image Container */
      .bg-image-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }

      .bg-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        object-position: center;
        opacity: 0;
        filter: grayscale(30%) contrast(1.1);
        animation: zoomIn 12s ease-out forwards;
      }

      @keyframes zoomIn {
        0% {
          opacity: 0;
          transform: scale(1.1);
        }
        10% {
          opacity: 1;
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      /* Dramatic overlay */
      .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          180deg,
          rgba(0, 0, 0, 0.4) 0%,
          rgba(0, 0, 0, 0.2) 30%,
          rgba(0, 0, 0, 0.3) 50%,
          rgba(0, 0, 0, 0.95) 85%,
          rgba(0, 0, 0, 1) 100%
        );
      }

      /* Accent line at top */
      .accent-line {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 8px;
        background: linear-gradient(90deg, #ff6b35, #f7c531, #ff6b35);
        transform: scaleX(0);
        transform-origin: left;
        animation: expandAccent 0.8s ease-out 0.5s forwards;
      }

      @keyframes expandAccent {
        to {
          transform: scaleX(1);
        }
      }

      /* Top section with logo and category */
      .top-section {
        position: absolute;
        top: 60px;
        left: 80px;
        right: 80px;
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
      }

      .logo-area {
        opacity: 0;
        transform: translateY(-30px);
        animation: dropIn 0.6s ease-out 0.8s forwards;
      }

      .logo-area svg {
        width: 280px;
        height: auto;
      }

      @keyframes dropIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Category badge */
      .category-badge {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 12px;
        opacity: 0;
        transform: translateX(30px);
        animation: slideInRight 0.6s ease-out 1s forwards;
      }

      @keyframes slideInRight {
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .category {
        font-family: "Bebas Neue", sans-serif;
        font-size: 42px;
        letter-spacing: 4px;
        color: #ff6b35;
        text-transform: uppercase;
      }

      .location {
        font-family: "Source Sans 3", sans-serif;
        font-size: 28px;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.7);
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      /* Main content area */
      .main-content {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        padding: 80px;
      }

      /* Tags row */
      .tags-row {
        display: flex;
        gap: 16px;
        margin-bottom: 40px;
        flex-wrap: wrap;
      }

      .tag {
        font-family: "Source Sans 3", sans-serif;
        font-size: 22px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 2px;
        padding: 10px 20px;
        background: rgba(255, 107, 53, 0.15);
        border: 2px solid rgba(255, 107, 53, 0.5);
        color: #ff6b35;
        border-radius: 4px;
        opacity: 0;
        transform: translateY(20px);
        animation: tagIn 0.4s ease-out forwards;
      }

      .tag:nth-child(1) { animation-delay: 1.2s; }
      .tag:nth-child(2) { animation-delay: 1.35s; }
      .tag:nth-child(3) { animation-delay: 1.5s; }

      @keyframes tagIn {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Headline */
      .headline {
        font-family: "Bebas Neue", sans-serif;
        font-size: 108px;
        line-height: 1.0;
        color: #ffffff;
        text-transform: uppercase;
        letter-spacing: 2px;
        margin-bottom: 40px;
        overflow: hidden;
      }

      .headline-word {
        display: inline-block;
        opacity: 0;
        transform: translateY(100%);
        animation: wordReveal 0.5s ease-out forwards;
      }

      @keyframes wordReveal {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Accent bar */
      .headline-accent {
        width: 120px;
        height: 8px;
        background: #ff6b35;
        margin-bottom: 40px;
        opacity: 0;
        transform: scaleX(0);
        transform-origin: left;
        animation: expandAccent 0.5s ease-out 4s forwards;
      }

      /* Summary text */
      .summary {
        font-family: "Source Sans 3", sans-serif;
        font-size: 38px;
        font-weight: 300;
        line-height: 1.5;
        color: rgba(255, 255, 255, 0.85);
        margin-bottom: 50px;
        max-width: 850px;
        opacity: 0;
        transform: translateY(30px);
        animation: fadeUp 0.7s ease-out 4.5s forwards;
      }

      @keyframes fadeUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Footer area */
      .footer-area {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-top: 30px;
        border-top: 1px solid rgba(255, 255, 255, 0.15);
        opacity: 0;
        animation: fadeIn 0.6s ease-out 5.5s forwards;
      }

      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }

      .source-info {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .source-name {
        font-family: "Source Sans 3", sans-serif;
        font-size: 26px;
        font-weight: 600;
        color: rgba(255, 255, 255, 0.9);
      }

      .date-text {
        font-family: "Source Sans 3", sans-serif;
        font-size: 24px;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.5);
      }

      /* Short URL / CTA */
      .cta-area {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 8px;
      }

      .short-url {
        font-family: "Source Sans 3", sans-serif;
        font-size: 28px;
        font-weight: 600;
        color: #f7c531;
        letter-spacing: 1px;
      }

      .swipe-hint {
        font-family: "Source Sans 3", sans-serif;
        font-size: 22px;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.5);
        text-transform: uppercase;
        letter-spacing: 2px;
      }

      /* Image credit */
      .image-credit {
        position: absolute;
        top: 180px;
        right: 80px;
        font-family: "Source Sans 3", sans-serif;
        font-size: 20px;
        font-weight: 400;
        color: rgba(255, 255, 255, 0.4);
        writing-mode: vertical-rl;
        text-orientation: mixed;
        opacity: 0;
        animation: fadeIn 0.5s ease-out 6s forwards;
      }

      /* Breaking/Live/Developing indicator */
      .status-indicator {
        display: none;
        position: absolute;
        top: 200px;
        left: 80px;
        padding: 16px 32px;
        font-family: "Bebas Neue", sans-serif;
        font-size: 36px;
        letter-spacing: 4px;
        border-radius: 4px;
        opacity: 0;
        animation: pulseIn 0.6s ease-out 0.6s forwards;
      }

      .status-indicator.breaking {
        display: block;
        background: #dc2626;
        color: white;
      }

      .status-indicator.live {
        display: block;
        background: #dc2626;
        color: white;
        animation: pulseIn 0.6s ease-out 0.6s forwards, livePulse 2s ease-in-out 1.2s infinite;
      }

      .status-indicator.developing {
        display: block;
        background: #f59e0b;
        color: #000;
      }

      @keyframes pulseIn {
        0% {
          opacity: 0;
          transform: scale(0.8);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes livePulse {
        0%, 100% {
          box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7);
        }
        50% {
          box-shadow: 0 0 0 20px rgba(220, 38, 38, 0);
        }
      }

      /* Loading state */
      .loading-container {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 30px;
      }

      .loading-spinner {
        width: 80px;
        height: 80px;
        border: 4px solid rgba(255, 255, 255, 0.2);
        border-top-color: #ff6b35;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .loading-text {
        font-family: "Source Sans 3", sans-serif;
        font-size: 28px;
        color: rgba(255, 255, 255, 0.6);
      }

      .hidden {
        display: none !important;
      }
    </style>
  </head>
  <body>
    <!-- Loading State -->
    <div class="loading-container" id="loading">
      <div class="loading-spinner"></div>
      <div class="loading-text">Loading story...</div>
    </div>

    <!-- Background Image -->
    <div class="bg-image-container">
      <img class="bg-image" id="bgImage" alt="" />
    </div>

    <!-- Overlay -->
    <div class="overlay"></div>

    <!-- Accent Line -->
    <div class="accent-line"></div>

    <!-- Status Indicator -->
    <div class="status-indicator" id="statusIndicator"></div>

    <!-- Top Section -->
    <div class="top-section">
      <div class="logo-area">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 166 60">
          <g fill="none">
            <path
              fill="#ff6b35"
              d="M118.38 27.06V24h-8.2v2.63h4.22l-4.34 6.3V36h8.42v-2.65h-4.43l4.33-6.29zm29.3 1.35c-.18.23-.42.33-1 .39h-1.14v-2.4h.89l.21.02c.46.01.65.07.85.21.5.32.62 1.2.19 1.78zm2.78 3.24c-.46-1.06-.62-1.28-1.06-1.48a1 1 0 00.21-.09c1.37-.61 2.02-2.16 1.5-3.88-.42-1.42-1.53-2.2-3.64-2.2h-4.94v12h3.14v-4.49h.71c.51 0 .82.22 1.08.86l.17.38.09.22L148.9 36h3.25l-1.52-3.93c-.06-.15-.1-.28-.17-.42zm7.1-.45l1.2-3.6 1.21 3.6h-2.4zm2.92-7.2h-3.5l-4.22 12h3.18l.71-2.2h4.07l.7 2.2h3.36l-4.3-12zm-60.05 7.2l1.2-3.6 1.2 3.6h-2.4zm-.6-7.2l-4.2 12h3.17l.72-2.2h4.06l.7 2.2h3.37l-4.3-12h-3.51zm-27.66 7.2l1.2-3.6 1.2 3.6h-2.4zm-.6-7.2l-4.21 12h3.18l.71-2.2h4.07l.69 2.2h3.37l-4.3-12h-3.51zm63.3 7.37h4.16v-2.56h-4.15v-2.18h4.82V24h-8v12h8.43v-2.55h-5.25v-2.08zm-10.82 0h4.16v-2.56h-4.16v-2.18h4.83V24h-8v12h8.42v-2.55h-5.25v-2.08zm-33.22 4.1c0 1.87-.65 2.55-2.08 2.12a1.05 1.05 0 01-.24-.08l-.7 2.66c.15.08.31.15.48.22 3.34 1.3 5.53-.63 5.53-4.04V24h-3v11.47zm-2.42-2.15h-3.97V24h-3.25v12h7.22v-2.68z"
            ></path>
            <path fill="#ff6b35" d="M0 0h60.14v60H0z"></path>
            <path
              d="M34.13 48.03c-.07.03-.1.16-.05.33l.33.87c.2.53.52 1.15.97 1.46.47.34.72.22.82.18.07-.04.37-.22.26-.7a2.99 2.99 0 00-.27-.85c-.1-.18-.22-.3-.3-.27-.04 0 0 .18 0 .28 0 .2-.07.33-.23.4-.14.06-.48.18-.74-.28-.22-.38-.4-.87-.49-1.08-.06-.15-.16-.34-.26-.34h-.04zm-7.47 1.38l1.59 1.32 1.54-1.87-1.59-1.32-1.54 1.87zm.35-3.26l1.59 1.31 1.55-1.86-1.6-1.32-1.54 1.87zm10.14-4.6l1.87.88 1.03-2.2-1.86-.88-1.04 2.2zM27.5 40a12.75 12.75 0 003.36 4.63c.14-.97.3-1.65.44-2.13-1.4-1-2.4-2.1-3.05-3.18l-.75.68zm3.54-2.35l1.86.88 1.04-2.2-1.87-.88-1.03 2.2zm-9-8.75s-1.17.83-1.64 1.92a2.4 2.4 0 00-.1 1.75c.16.35.55.68 1.06.28.35-.28.5-.68.58-1.01.05-.2.06-.33.06-.43 0-.12-.04-.22-.15-.2-.34.11-.14.57-.38.79-.18.1-.66.05-.75-.42-.1-.47.27-1.07.6-1.47.32-.4.9-.92.9-.92s.4-.34.27-.51l-.04-.01c-.12 0-.41.23-.41.23zM33.5 27.7l-1.44 1.57-1.24 1.35c-.27.3-.41.6-.38.76l.17.82c.04-.15.22-.43.4-.64.14-.15.8-.89 1.45-1.58l1.23-1.35c.27-.3.41-.6.38-.76l-.17-.81c-.04.15-.21.42-.4.64zM17.97 39.53c.22-.72.64-1.37 1.35-1.78 1.18-.55 1.64.86 1.64.86-.08.95-.8 1.45-1.61 1.45-.47 0-.98-.17-1.38-.53zm8.75-22.88a1.45 1.45 0 101.16 2.38l.03-.04c.17 1.16-.38 2.08-1.67 3.15-1.31 1.12-4.4 2.56-6.58 4.3a9.8 9.8 0 00-3.68 10.51 13.93 13.93 0 00.86 2.44 14.3 14.3 0 00.87 5.79c1.08 2.42 3.01 4.4 5.79 3.82 2.8-.66 3.12-5.22 3.43-8.55.09-.55.17-.65.34-.79.45-.38 1.54-1.4 2.06-1.86.32-.29.6-.57.79-.94.23-.44.1-1.02.1-1.02l-.3-2.2c-.09.31-.47.75-1 1.29-.56.56-2.05 1.84-2.19 1.98-.13.14-.61.5-.82 2.17-.54 4.55-1.43 6.7-3.04 7.43-.43.2-.9.3-1.43.3-2.95-.02-3.73-3.62-3.72-5.59 0-.12 0-.24.02-.34.68.92 1.7 1.84 2.94 1.65 2-.3 1.37-3.67 1.08-4.45-.28-.78-1.05-3.13-2.72-3.01-1.18.08-1.73 1.47-1.99 2.64a9.49 9.49 0 01-.27-2.86c.17-2.04.87-4.58 3.83-7.08 2.1-1.78 4.5-3.06 5.82-4.1a5.35 5.35 0 001.66-2.12 9.58 9.58 0 01-.57 2.27c-1.23 3.23-4.95 8.57-5 16.1 0 2.32.22 4.32.59 6.03.2-.13.39-.32.57-.53-.26-1.23-.4-2.58-.4-4.03 0-7.52 3.69-12.84 4.89-16.07.63-1.7.65-2.93.65-4.15 0-1.5-.34-3.07-.65-3.68-.34-.58-.75-.84-1.38-.84h-.07zm3.63-10.3c-.74.51-1.36 1.7-1.36 3.5 0 1.1.32 2.43 1.17 3.92-1.15 1.56-1.36 3-.87 4.38.37 1.05.56 1.32.73 1.95.42 1.6-.05 3.5-1.3 6.46-1.02 2.4-2.35 4.92-2.35 7.98 0 .7.07 1.39.17 2.06.11-.12.37-.35.67-.64-.15-2.4.8-4.81 1.98-6.98 1.7-3.17 1.92-6.39 1.59-8.15 1.2 1.28 3.22 3.2 4.4 5.16.4.66.64 1.29.7 1.93a5.04 5.04 0 01-1.39 3.76c-.8.92-.53 1.73-.5 1.9.07.25.4 1.26.63 1.91.9-1.75 3.36-2.73 4.48-4.19.25 1.8-1.1 3.5-2.1 4.64-.23.26-.5.52-.79.8-1.9 1.82-3.14 3.06-3.8 4.22-.16.26-.44.83-.57 1.27-.2.56-.44 1.5-.65 3.15a75.6 75.6 0 00-.39 2.66c-.13 1.19-.48 3.06-1.94 3.6-.07.03-.15.05-.23.06v.01c-1.39.3-2.8-.86-3.83-2.94-.22.16-.45.3-.7.42 1.4 3.3 3.5 4.81 5.33 4.81 1.4 0 2.5-.7 2.85-2.75.18-1.03.31-2.18.43-3.29.06-.53.32-3.55.8-4.65.6-1.23 1.92-2.41 3.88-4.43 1.2-1.25 1.87-2.3 2.21-3.14 1.14-2.08-.27-7.04-.55-7.94 0-.03 0-.04-.03-.04-.02 0-.03.01-.05.05l-.01.02c-.5.82-1.4 1.57-2.25 2.18.48-1.29.35-2.27.16-3.1l-.04-.15c-.85-3.29-4.21-6.22-5.73-7.9-1.98-2.2-1.3-3.6-.58-4.5l.44.63c2.69 3.64 7.74 9.41 10.4 14.91a18.44 18.44 0 011.46 4.06c1.05 5.7-2.93 11.49-8.9 9.86l-.11-.03c-.16.5-.31 1.31-.46 2.41.9.39 1.88.62 2.83.66h.21c4.9.06 8.73-3.6 8.03-11.3 0 0-.3-3.2-1.95-6.58-2.65-5.92-7.56-11.78-10.57-15.57a10.04 10.04 0 01-1.8-3.14c-.56-1.75-.2-3.11.52-3.7.16-.13.35-.28.53-.37.1-.06.06-.18-.01-.2h-.07c-.1 0-.3.05-.72.34zm-5.5 12.8c-.8.02-1.44.69-1.41 1.5a1.45 1.45 0 102.9-.1 1.45 1.45 0 00-1.45-1.4h-.05z"
              fill="#FFF"
            ></path>
          </g>
        </svg>
      </div>
      <div class="category-badge">
        <div class="category" id="category"></div>
        <div class="location" id="location"></div>
      </div>
    </div>

    <!-- Image Credit -->
    <div class="image-credit" id="imageCredit"></div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="tags-row" id="tags"></div>
      <h1 class="headline" id="headline"></h1>
      <div class="headline-accent"></div>
      <p class="summary" id="summary"></p>
      <div class="footer-area">
        <div class="source-info">
          <div class="source-name" id="source"></div>
          <div class="date-text" id="date"></div>
        </div>
        <div class="cta-area">
          <div class="short-url" id="shortUrl"></div>
          <div class="swipe-hint">Swipe up to read</div>
        </div>
      </div>
    </div>

    <script src="/shared/story.js"></script>
    <script>
      // Animate headline word by word
      function animateHeadline(text, container) {
        const words = text.split(" ");
        container.innerHTML = "";
        
        words.forEach((word, index) => {
          const span = document.createElement("span");
          span.className = "headline-word";
          span.textContent = word + " ";
          span.style.animationDelay = `${1.8 + index * 0.12}s`;
          container.appendChild(span);
        });
      }

      // Custom render function for this template
      async function renderContent(articleData) {
        // Hide loading
        document.getElementById("loading").classList.add("hidden");

        // Set background image
        if (articleData.imageUrl) {
          const bgImage = document.getElementById("bgImage");
          bgImage.src = articleData.imageUrl;
        }

        // Set status indicator
        const statusIndicator = document.getElementById("statusIndicator");
        if (articleData.isBreaking) {
          statusIndicator.textContent = "Breaking";
          statusIndicator.classList.add("breaking");
        } else if (articleData.isLive) {
          statusIndicator.textContent = "Live";
          statusIndicator.classList.add("live");
        } else if (articleData.isDeveloping) {
          statusIndicator.textContent = "Developing";
          statusIndicator.classList.add("developing");
        }

        // Set category
        if (articleData.category) {
          document.getElementById("category").textContent = articleData.category;
        }

        // Set location
        if (articleData.location) {
          document.getElementById("location").textContent = articleData.location;
        }

        // Set tags (use primaryTagsTermName and other tags)
        const tagsContainer = document.getElementById("tags");
        const tags = [];
        if (articleData.primaryTag) tags.push(articleData.primaryTag);
        if (articleData.tags && Array.isArray(articleData.tags)) {
          articleData.tags.slice(0, 2).forEach(tag => {
            if (tag.title && !tags.includes(tag.title)) {
              tags.push(tag.title);
            }
          });
        }
        tagsContainer.innerHTML = tags
          .slice(0, 3)
          .map((tag) => `<span class="tag">${tag}</span>`)
          .join("");

        // Set headline with word-by-word animation
        const headlineContainer = document.getElementById("headline");
        animateHeadline(articleData.title, headlineContainer);

        // Set summary (use socialMediaSummary or excerpt)
        const summary = articleData.socialMediaSummary || articleData.excerpt || "";
        document.getElementById("summary").textContent = summary;

        // Set source
        document.getElementById("source").textContent = articleData.source || "Al Jazeera";

        // Set date
        if (articleData.date) {
          document.getElementById("date").textContent =
            window.StoryMaker.formatDate(articleData.date);
        }

        // Set short URL
        if (articleData.shortUrl) {
          document.getElementById("shortUrl").textContent = articleData.shortUrl;
        }

        // Set image credit
        if (articleData.imageCredit) {
          document.getElementById("imageCredit").textContent = `Photo: ${articleData.imageCredit}`;
        }

        // Wait for background image to load
        if (articleData.imageUrl) {
          const bgImage = document.getElementById("bgImage");
          await new Promise((resolve) => {
            if (bgImage.complete) {
              resolve();
            } else {
              bgImage.onload = resolve;
              bgImage.onerror = resolve;
            }
          });
        }
      }

      // Custom animation timing
      async function animateContent() {
        return new Promise((resolve) => {
          setTimeout(resolve, 10000);
        });
      }

      // Initialize when DOM is ready
      document.addEventListener("DOMContentLoaded", () => {
        window.StoryMaker.initStory({
          renderContent: renderContent,
          animateContent: animateContent,
        });
      });
    </script>
  </body>
</html>
